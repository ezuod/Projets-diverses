import{d as k,r as u,g as C,c as r,a as o,t as c,h as y,o as i,_ as h,i as D,j as v,k as f,l as R,u as F,w as L,v as N,m as V,F as w,b as x,n as U,f as B}from"./index-HcSUfxfB.js";import{a as m}from"./http-api-CPBsOJx4.js";import{_}from"./Image.vue_vue_type_style_index_0_lang-CLTV9Wq3.js";const E={key:0,class:"details-container"},j={key:1},O=k({__name:"Details",props:{id:{}},setup(g){const d=g,n=u(null);return C(async()=>{try{const t=await m.getImageDetails(d.id);n.value=t}catch(t){console.error("Failed to fetch image details:",t)}}),(t,s)=>n.value?(i(),r("div",E,[o("h4",null,c(n.value.name),1),o("p",null,[s[0]||(s[0]=o("strong",null,"Type:",-1)),y(" "+c(n.value.type)+" ",1),s[1]||(s[1]=o("strong",null," Size:",-1)),y(" "+c(n.value.size),1)])])):(i(),r("div",j,s[2]||(s[2]=[o("p",null,"Loading image details...",-1)])))}}),z=h(O,[["__scopeId","data-v-7918cc08"]]),M={class:"similar-controls"},T=["onClick"],P={class:"distance"},q=k({__name:"View",props:{id:{}},setup(g){const d=D(),n=F(),t=u(Number(d.params.id)||0),s=u(5),b=u([]),I=async()=>{try{await m.deleteImage(t.value),alert("Image deleted successfully"),n.push("/gallery")}catch(e){console.error("Failed to delete image:",e),alert("Failed to delete image")}},p=async e=>{try{const a=await m.getSimilarImages(t.value,e);b.value=a}catch(a){console.error("Error fetching similar images:",a)}},S=e=>{n.push({name:"view",params:{id:e.toString()}})},$=async()=>{try{const e=await m.getImage(t.value),a=window.URL.createObjectURL(e),l=document.createElement("a");l.href=a,l.download=`image-${t.value}`,l.click(),window.URL.revokeObjectURL(a)}catch(e){console.error("Error downloading image:",e)}};return v(()=>d.params.id,e=>{t.value=Number(e)||0,p(s.value)},{immediate:!0}),v(s,e=>{e>0&&p(e)}),v(t,()=>{p(s.value)},{immediate:!0}),(e,a)=>(i(),r(w,null,[o("button",{onClick:a[0]||(a[0]=l=>{R(n).push("/gallery")}),class:"return-button"},"Return"),o("button",{onClick:I,class:"delete-button"},"Delete"),o("button",{onClick:$,class:"download-button"},"Download"),(i(),f(z,{id:t.value,key:t.value},null,8,["id"])),(i(),f(_,{id:t.value,key:t.value,class:"img"},null,8,["id"])),o("div",M,[a[3]||(a[3]=o("h4",null,"Similar to this one:",-1)),L(o("select",{id:"number-select","onUpdate:modelValue":a[1]||(a[1]=l=>s.value=l),class:"number-select"},a[2]||(a[2]=[V('<option value="1" data-v-0d6300eb>1</option><option value="3" data-v-0d6300eb>3</option><option value="5" data-v-0d6300eb>5</option><option value="10" data-v-0d6300eb>10</option><option value="20" data-v-0d6300eb>20</option>',5)]),512),[[N,s.value]])]),o("div",U(e.$attrs,{class:"gallery"}),[(i(!0),r(w,null,x(b.value,l=>(i(),r("div",{key:l.id,class:"img-wrapper",onClick:A=>S(l.id)},[B(_,{id:l.id,class:"image-similar"},null,8,["id"]),o("span",P,c(l.distance.toFixed(2)),1)],8,T))),128))],16)],64))}}),K=h(q,[["__scopeId","data-v-0d6300eb"]]);export{K as default};
