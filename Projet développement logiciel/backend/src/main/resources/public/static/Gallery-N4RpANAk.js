import{d as y,r as f,c,w as C,a as i,b as g,v as E,e as I,o as d,f as S,g as B,F as _,h as $,i as w,n as b,u as F}from"./index-6l5cUpBE.js";import{a as m}from"./http-api-C6L_lunH.js";import{_ as G}from"./Image.vue_vue_type_style_index_0_lang-C-u1tQBl.js";import M from"./Upload-ku3pfVFf.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"search-bar"},P=y({__name:"Bar",emits:["search"],setup(k,{emit:p}){const a=f(""),n=p;function r(){if(!a.value.trim()){n("search","");return}n("search",a.value.trim())}return(v,l)=>(d(),c("div",N,[C(i("input",{"onUpdate:modelValue":l[0]||(l[0]=u=>a.value=u),type:"text",placeholder:"Type keywords...",onKeyup:I(r,["enter"])},null,544),[[E,a.value]]),i("button",{onClick:r},"Search"),g(M)]))}}),T=D(P,[["__scopeId","data-v-325b954e"]]),V={class:"gallery"},j=["onClick"],K=y({__name:"Gallery",setup(k){const p=F(),a=f([]),n=f(!1);S(()=>{r(),window.addEventListener("imageUploaded",r)}),B(()=>{window.removeEventListener("imageUploaded",r)});function r(){m.getImageList().then(e=>{a.value=e}).catch(e=>{console.error("Failed to fetch images:",e.message)})}function v(e){if(!e){r();return}m.searchImages(e).then(t=>{a.value=t}).catch(t=>{console.error("Search failed:",t.message),a.value=[]})}const l=e=>{p.push(`/view_image/${e}`)};function u(e){e.preventDefault(),n.value=!0}function L(){n.value=!1}function U(e){var o;e.preventDefault(),n.value=!1;const t=(o=e.dataTransfer)==null?void 0:o.files;if(t&&t.length>0){const s=t[0];if(s.type==="image/png"||s.type==="image/jpeg"||s.type==="image/jpg"){const h=new FormData;h.append("file",s),m.createImage(h).then(()=>{window.dispatchEvent(new Event("imageUploaded"))}).catch(x=>{console.error("Upload failed:",x.message)})}else alert("Please drop a PNG or JPEG image.")}}return(e,t)=>(d(),c(_,null,[i("header",null,[g(T,{onSearch:v})]),i("div",{class:b(["gallery-container",{dragging:n.value}]),onDragover:w(u,["prevent"]),onDragleave:L,onDrop:w(U,["prevent"])},[i("div",V,[(d(!0),c(_,null,$(a.value,o=>(d(),c("div",{key:o.id,class:"img-wrapper",onClick:s=>l(o.id)},[g(G,{id:o.id},null,8,["id"])],8,j))),128))])],34)],64))}}),A=D(K,[["__scopeId","data-v-5f08cde8"]]);export{A as default};
